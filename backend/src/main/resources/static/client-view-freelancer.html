<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Profile | Nutzy Craft</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Quicksand:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="profile.css">
    <script src="script.js" defer></script>
</head>

<body>

    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="dashboard-sidebar">
            <a href="index.html" class="sidebar-logo">
                <img src="logo.jpg" alt="Logo" style="width: 40px; border-radius: 50%;">
                Nutzy Craft
            </a>

            <ul class="sidebar-menu">
                <li class="sidebar-item">
                    <a href="client-dashboard.html" class="sidebar-link">
                        <i class="fa-solid fa-grid-2"></i> Dashboard
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="post-job.html" class="sidebar-link">
                        <i class="fa-solid fa-plus-circle"></i> Post a Job
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="client-my-jobs.html" class="sidebar-link">
                        <i class="fa-solid fa-briefcase"></i> My Jobs
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="find-freelancer.html" class="sidebar-link active">
                        <i class="fa-solid fa-users"></i> Find Freelancers
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="client-messages.html" class="sidebar-link">
                        <i class="fa-solid fa-message"></i> Messages
                        <span
                            style="margin-left: auto; background: var(--primary); color: white; padding: 2px 6px; border-radius: 6px; font-size: 0.75rem;">2</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="client-settings.html" class="sidebar-link">
                        <i class="fa-solid fa-gear"></i> Settings
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="client-support.html" class="sidebar-link">
                        <i class="fa-solid fa-headset"></i> Support
                    </a>
                </li>
            </ul>

            <div class="sidebar-user">
                <img src="https://ui-avatars.com/api/?name=Client+User&background=D4B69D&color=fff"
                    style="width: 40px; height: 40px; border-radius: 50%;">
                <div style="flex: 1;">
                    <div style="font-weight: 700; font-size: 0.9rem;">Client User</div>
                    <div style="font-size: 0.8rem; color: #888;">Client</div>
                </div>
                <a href="logout.html" style="color: #888;"><i class="fa-solid fa-sign-out-alt"></i></a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Topbar -->
            <div class="dashboard-topbar">
                <button class="sidebar-toggle-btn"><i class="fa-solid fa-bars"></i></button>
                <div>
                    <h2 class="dashboard-title" style="font-size: 1.5rem;">Freelancer Profile</h2>
                    <p style="color: #666;">View candidate details and portfolio.</p>
                </div>
                <div class="topbar-actions">
                    <a href="javascript:history.back()" class="btn btn-outline"><i class="fa-solid fa-arrow-left"></i>
                        Back</a>
                </div>
            </div>

            <!-- Profile Content (Wrapped to fit dashboard) -->
            <div class="profile-container" style="padding: 0; margin: 0; width: 100%;">
                <!-- 1. Profile Header -->
                <div class="glass-card profile-header-card">
                    <div class="profile-banner"></div>
                    <div class="profile-header-content">
                        <img src="https://ui-avatars.com/api/?name=User&background=D4B69D&color=fff&size=200"
                            alt="Avatar" class="profile-avatar-large" id="profileAvatar">
                        <div class="profile-info">
                            <div class="profile-name-row">
                                <h1 class="profile-name" id="profileName">Loading...</h1>
                                <div class="badge-verified"><i class="fa-solid fa-check"></i></div>
                            </div>
                            <p class="profile-title" id="profileTitle">Freelancer</p>
                            <div class="profile-meta">
                                <div class="meta-item"><i class="fa-solid fa-location-dot"></i> Remote</div>
                                <div class="status-badge"><span
                                        style="width: 8px; height: 8px; background: #2e7d32; border-radius: 50%; display: inline-block; margin-right: 5px;"></span>
                                    Available</div>
                            </div>
                            <div style="margin-top: 15px; display: flex; align-items: center; gap: 15px;">
                                <span style="font-size: 1.5rem; font-weight: 800; color: var(--primary);">$<span
                                        id="profileRate">0</span><span
                                        style="font-size: 1rem; color: var(--text-muted); font-weight: 600;">/hr</span></span>
                                <div style="display: flex; color: #ffc107;">
                                    <i class="fa-solid fa-star"></i>
                                    <span style="color: var(--text-muted); margin-left: 5px; font-weight: 600;"
                                        id="profileRating">(0.0)</span>
                                </div>
                            </div>
                        </div>
                        <div class="profile-actions">
                            <button class="btn btn-primary" style="padding: 12px 30px;">Hire Me</button>
                        </div>
                    </div>
                </div>

                <div class="profile-grid-layout">
                    <!-- Left Column: Main Content -->
                    <div class="profile-main">
                        <!-- 2. About Me -->
                        <div class="glass-card profile-section">
                            <h3 class="section-title"><i class="fa-solid fa-user"></i> About Me</h3>
                            <p style="color: var(--text-muted); line-height: 1.8;" id="profileBio">
                                Loading...
                            </p>
                        </div>
                    </div>

                    <!-- Right Column: Sidebar -->
                    <div class="profile-sidebar">
                        <!-- 3. Skills -->
                        <div class="glass-card profile-section">
                            <h3 class="section-title" style="font-size: 1.2rem;">Skills</h3>
                            <div class="skills-tags" id="profileSkills">
                                <!-- Dynamic Skills -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    const params = new URLSearchParams(window.location.search);
                    const id = params.get('id');

                    if (!id) {
                        document.querySelector('.profile-container').innerHTML = '<p class="text-center">No freelancer ID provided.</p>';
                        return;
                    }

                    fetch(`http://localhost:8080/api/freelancers/${id}`)
                        .then(res => {
                            if (!res.ok) throw new Error("Freelancer not found");
                            return res.json();
                        })
                        .then(freelancer => {
                            const user = freelancer.user || {};

                            document.getElementById('profileName').textContent = user.fullName || 'Unknown';
                            document.getElementById('profileTitle').textContent = freelancer.title || 'Freelancer';
                            document.getElementById('profileBio').textContent = freelancer.bio || 'No bio provided.';
                            document.getElementById('profileRate').textContent = freelancer.hourlyRate || 0;
                            document.getElementById('profileRating').textContent = `(${freelancer.rating || 0.0})`;
                            document.getElementById('profileAvatar').src = `https://ui-avatars.com/api/?name=${user.fullName}&background=random&size=200`;

                            const skillsContainer = document.getElementById('profileSkills');
                            skillsContainer.innerHTML = '';
                            if (freelancer.skills && freelancer.skills.length > 0) {
                                freelancer.skills.forEach(skill => {
                                    const span = document.createElement('span');
                                    span.className = 'skill-tag';
                                    span.textContent = skill;
                                    skillsContainer.appendChild(span);
                                });
                            } else {
                                skillsContainer.innerHTML = '<span style="color:#888;">No skills listed.</span>';
                            }
                        })
                        .catch(err => {
                            console.error(err);
                            document.querySelector('.profile-container').innerHTML = '<p class="text-center">Failed to load profile.</p>';
                        });
                });
            </script>

        </main>
    </div>

</body>

</html>